<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flashcards: Geography Vocabulary</title>
  <style>
    :root{ --bg:#0f172a; --panel:#0a0f1a; --card:#0b1220; --border:#1f2937; --fg:#e5e7eb; --muted:#9ca3af; --acc:#22d3ee; --good:#34d399; }
    html,body{height:100%; margin:0; background: radial-gradient(70rem 60rem at 50% -10%, #0b1220 0%, var(--bg) 40%, #070b14 100%); font-family: system-ui,-apple-system,Segoe UI,Roboto,"Hiragino Kaku Gothic ProN",Meiryo,sans-serif;}
    .container{max-width:960px; margin:0 auto; padding:16px 16px 72px;}
    header{display:flex; gap:12px; align-items:center; justify-content:space-between; color:var(--fg); margin-top:12px}
    header .title{font-weight:800; letter-spacing:.3px; white-space:normal; word-break:break-word; line-height:1.25}
    .card{margin-top:14px; background:linear-gradient(180deg,#0a1322,#0a0f1a); border:1px solid var(--border); border-radius:20px; padding:24px; display:grid; grid-template-columns:1fr; gap:16px; align-items:start; box-shadow:0 10px 30px rgba(0,0,0,.35);}    
    .term-mean{display:flex; align-items:baseline; gap:12px; flex-wrap:wrap}
    .term{font-size:36px; line-height:1.2; color:var(--fg); font-weight:800;}
    .mean{font-size:24px; color:var(--acc);} /* 答え=薄い青緑 */
    .phrases{display:flex; flex-direction:column; gap:8px}
    .phrase-line{display:flex; flex-direction:column; gap:2px; align-items:flex-start}
    .phrase-en{color:var(--fg); font-size:16px}
    .phrase-ja{color:var(--muted); font-size:16px; line-height:1.4; min-height:1.4em}
    .foot{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-top:10px; color:var(--muted); flex-wrap:wrap}
    .meters{display:flex; gap:12px; align-items:center; flex-wrap:wrap}
    .meter{display:flex; align-items:center; gap:8px}
    .bar{position:relative; width:220px; height:10px; background:#0c1220; border:1px solid var(--border); border-radius:999px; overflow:hidden}
    .fill{position:absolute; inset:0; width:0%; background:linear-gradient(90deg, var(--acc), var(--good)); box-shadow:0 0 20px rgba(34,211,238,.4) inset}
    .count{font-weight:700; color:var(--fg)}
    .hint{font-size:12px; color:var(--muted)}
    a.back{color:var(--acc); text-decoration:none; font-size:14px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="title">Geography Flashcards<br/>地理語彙フラッシュカード</div>
    </header>

    <section class="card" aria-live="polite" id="card" tabindex="0">
      <div class="term-mean">
        <div class="term" id="term">...</div>
        <div class="mean" id="meaning"></div>
      </div>
      <div class="phrases" id="phrases"></div>
      <div class="foot">
        <div class="meters" aria-live="polite">
          <div class="meter" title="この周回の進捗">
            <span class="badge">Cycle</span>
            <div class="bar" aria-label="Reveal Cycle Progress" role="progressbar" aria-valuemin="0" aria-valuemax="10" aria-valuenow="0">
              <div class="fill" id="cycleFill"></div>
            </div>
            <span class="badge" id="cycleText">0 / 10</span>
          </div>
          <div class="meter" title="トータルの表示回数">
            <span class="badge">Reveals</span>
            <span class="count" id="revealCount">0</span>
          </div>
        </div>
        <div id="progress">0 / 0</div>
        <div class="hint">タップ/クリックで答えを表示 → もう一度で次へ（Space/Enter/→も可）</div>
      </div>
    </section>
  </div>
  <div style="padding:16px; max-width:960px; margin:0 auto"><a class="back" href="index.html">戻る</a></div>

  <script>
  // --- Data: Geography -------------------------------------------------
  const dataset = [
    { en:'continent', ja:'大陸', phrases:[
      {en:'Africa is the second-largest continent.', ja:'アフリカは世界で二番目に大きい大陸である。'},
      {en:'Each continent has distinct landforms and cultures.', ja:'各大陸には独自の地形と文化がある。'},
      {en:'The supercontinent Pangaea existed millions of years ago.', ja:'超大陸パンゲアは数億年前に存在した。'}
    ] },
    { en:'ocean', ja:'海洋', phrases:[
      {en:'The Pacific Ocean is the deepest ocean on Earth.', ja:'太平洋は地球で最も深い海洋である。'},
      {en:'Oceans regulate climate by storing heat.', ja:'海洋は熱を蓄えることで気候を調節する。'},
      {en:'Ocean currents influence regional weather.', ja:'海流は地域の天候に影響を与える。'}
    ] },
    { en:'mountain range', ja:'山脈', phrases:[
      {en:'The Himalayas are a young mountain range.', ja:'ヒマラヤは若い山脈である。'},
      {en:'Mountain ranges form at convergent plate boundaries.', ja:'山脈は収束型のプレート境界で形成される。'},
      {en:'A rain shadow can form on the leeward side.', ja:'風下側には雨陰（レインシャドー）が生じることがある。'}
    ] },
    { en:'plateau', ja:'高原', phrases:[
      {en:'A plateau is a broad, flat area at high elevation.', ja:'高原は標高の高い広い平坦地である。'},
      {en:'The Tibetan Plateau affects Asian climate patterns.', ja:'チベット高原はアジアの気候パターンに影響する。'},
      {en:'Erosion can carve deep canyons into plateaus.', ja:'浸食は高原に深い峡谷を刻むことがある。'}
    ] },
    { en:'plain', ja:'平原', phrases:[
      {en:'Floodplains form along large rivers.', ja:'氾濫原は大河川に沿って形成される。'},
      {en:'Plains often have fertile soils for farming.', ja:'平原は農業に適した肥沃な土壌を持つことが多い。'},
      {en:'Grasslands are common on temperate plains.', ja:'温帯の平原には草原が広がることが多い。'}
    ] },
    { en:'valley', ja:'谷・渓谷', phrases:[
      {en:'A valley is a low area between hills or mountains.', ja:'谷は丘や山の間の低地である。'},
      {en:'Glacial valleys often have U-shaped profiles.', ja:'氷河谷はしばしばU字谷の形をしている。'},
      {en:'Rivers carve V-shaped valleys over time.', ja:'河川は時間をかけてV字谷を刻む。'}
    ] },
    { en:'river', ja:'川・河川', phrases:[
      {en:'A river flows from its source to its mouth.', ja:'河川は水源から河口へ流れる。'},
      {en:'Major rivers create fertile deltas.', ja:'大河川は肥沃な三角州を形成する。'},
      {en:'The discharge increases after heavy rainfall.', ja:'大雨の後は流量が増える。'}
    ] },
    { en:'delta', ja:'三角州', phrases:[
      {en:'A delta forms where a river meets a standing body of water.', ja:'三角州は川が静水域に合流する所で形成される。'},
      {en:'Sediment builds up and creates new land.', ja:'堆積物が積み重なり新しい土地を生む。'},
      {en:'Deltas often support dense populations.', ja:'三角州は人口が密集することが多い。'}
    ] },
    { en:'estuary', ja:'河口（エスチュアリー）', phrases:[
      {en:'An estuary is a mixing zone of fresh and salt water.', ja:'エスチュアリーは淡水と海水が混ざる領域である。'},
      {en:'Estuaries provide rich habitats for wildlife.', ja:'河口域は豊かな生息環境を提供する。'},
      {en:'Tides strongly influence estuarine currents.', ja:'潮汐は河口域の流れに大きく影響する。'}
    ] },
    { en:'island', ja:'島', phrases:[
      {en:'An island is a landmass surrounded by water.', ja:'島は水に囲まれた陸地である。'},
      {en:'Volcanic activity can create new islands.', ja:'火山活動は新しい島を作り得る。'},
      {en:'Island ecosystems often evolve unique species.', ja:'島の生態系では固有種が進化しやすい。'}
    ] },
    { en:'peninsula', ja:'半島', phrases:[
      {en:'A peninsula is almost surrounded by water.', ja:'半島はほぼ水に囲まれている。'},
      {en:'Peninsulas can be strategic for trade routes.', ja:'半島は交易ルート上で戦略的となることがある。'},
      {en:'Isthmuses connect peninsulas to mainlands.', ja:'地峡は半島と本土をつなぐ。'}
    ] },
    { en:'archipelago', ja:'群島', phrases:[
      {en:'Japan is an island nation in a large archipelago.', ja:'日本は大きな群島にある島国である。'},
      {en:'Archipelagos often form along plate boundaries.', ja:'群島はプレート境界に沿って形成されることが多い。'},
      {en:'Ferries connect islands across the archipelago.', ja:'群島内の島々はフェリーで結ばれている。'}
    ] },
    { en:'coastline', ja:'海岸線', phrases:[
      {en:'Coastlines change due to erosion and deposition.', ja:'海岸線は侵食と堆積で変化する。'},
      {en:'Rocky coastlines feature cliffs and headlands.', ja:'岩石海岸には断崖や岬が見られる。'},
      {en:'Mangroves protect tropical coastlines from storms.', ja:'マングローブは熱帯の海岸線を嵐から守る。'}
    ] },
    { en:'climate', ja:'気候', phrases:[
      {en:'Climate describes long-term weather patterns.', ja:'気候は長期的な天候の傾向を指す。'},
      {en:'Monsoon climates have seasonal wind shifts.', ja:'モンスーン気候は季節風の変化が特徴だ。'},
      {en:'Köppen climate types classify global climates.', ja:'ケッペンの気候区分は世界の気候を分類する。'}
    ] },
    { en:'weather', ja:'天気', phrases:[
      {en:'Weather can change from hour to hour.', ja:'天気は時間ごとに変わり得る。'},
      {en:'A cold front often brings heavy rain.', ja:'寒冷前線は強い雨をもたらすことが多い。'},
      {en:'Forecasts estimate future weather conditions.', ja:'予報は将来の天気状況を見積もる。'}
    ] },
    { en:'precipitation', ja:'降水（量）', phrases:[
      {en:'Precipitation includes rain, snow, and hail.', ja:'降水には雨・雪・雹が含まれる。'},
      {en:'Orographic lifting increases precipitation on windward slopes.', ja:'地形性上昇は風上斜面の降水を増やす。'},
      {en:'Annual precipitation varies by region.', ja:'年間降水量は地域によって異なる。'}
    ] },
    { en:'latitude', ja:'緯度', phrases:[
      {en:'Latitude measures distance north or south of the Equator.', ja:'緯度は赤道からの南北方向の距離を示す。'},
      {en:'High latitudes receive less direct sunlight.', ja:'高緯度は直射日光が少ない。'},
      {en:'Parallels are lines of equal latitude.', ja:'緯線は同じ緯度の線である。'}
    ] },
    { en:'longitude', ja:'経度', phrases:[
      {en:'Longitude measures distance east or west of the Prime Meridian.', ja:'経度は本初子午線からの東西の距離を示す。'},
      {en:'Meridians meet at the poles.', ja:'子午線は両極で収束する。'},
      {en:'Time zones roughly follow lines of longitude.', ja:'時間帯は概ね経線に沿っている。'}
    ] },
    { en:'Equator', ja:'赤道', phrases:[
      {en:'The Equator divides Earth into two hemispheres.', ja:'赤道は地球を二つの半球に分ける。'},
      {en:'Equatorial regions are generally warm and humid.', ja:'赤道域は一般に高温多湿である。'},
      {en:'Day length near the Equator changes little year-round.', ja:'赤道付近では日長の季節変化が小さい。'}
    ] },
    { en:'Prime Meridian', ja:'本初子午線', phrases:[
      {en:'The Prime Meridian passes through Greenwich, London.', ja:'本初子午線はロンドンのグリニッジを通る。'},
      {en:'It defines 0 degrees longitude.', ja:'それは経度0度を定義する。'},
      {en:'Global timekeeping is based on this reference.', ja:'世界の時刻系はこの基準に基づく。'}
    ] },
    { en:'hemisphere', ja:'半球', phrases:[
      {en:'Earth has Northern and Southern Hemispheres.', ja:'地球には北半球と南半球がある。'},
      {en:'The Western Hemisphere includes the Americas.', ja:'西半球には南北アメリカが含まれる。'},
      {en:'Seasons are opposite between hemispheres.', ja:'半球間では季節が逆になる。'}
    ] },
    { en:'altitude', ja:'高度', phrases:[
      {en:'Altitude is the height above sea level.', ja:'高度は海抜のことである。'},
      {en:'Higher altitude leads to thinner air.', ja:'高高度では空気が薄くなる。'},
      {en:'Temperature generally decreases with altitude.', ja:'気温は一般に高度とともに下がる。'}
    ] },
    { en:'terrain', ja:'地形（起伏）', phrases:[
      {en:'Rugged terrain makes travel difficult.', ja:'険しい地形は移動を困難にする。'},
      {en:'Maps show terrain with contour lines.', ja:'地形図は等高線で起伏を示す。'},
      {en:'Flat terrain is suitable for building cities.', ja:'平坦な地形は都市建設に向いている。'}
    ] },
    { en:'desert', ja:'砂漠', phrases:[
      {en:'Deserts receive very little precipitation.', ja:'砂漠は降水量が非常に少ない。'},
      {en:'Cold deserts exist at high latitudes.', ja:'高緯度には寒冷砂漠も存在する。'},
      {en:'Oases support life in desert regions.', ja:'オアシスは砂漠地域の生命を支える。'}
    ] },
    { en:'rainforest', ja:'熱帯雨林', phrases:[
      {en:'Rainforests have high biodiversity.', ja:'熱帯雨林は生物多様性が高い。'},
      {en:'They require warm temperatures and abundant rainfall.', ja:'高温多湿の環境が必要である。'},
      {en:'Deforestation threatens rainforest ecosystems.', ja:'森林破壊は熱帯雨林の生態系を脅かす。'}
    ] },
    { en:'savanna', ja:'サバンナ（熱帯草原）', phrases:[
      {en:'Savannas feature grasslands with scattered trees.', ja:'サバンナは点在する樹木を伴う草原である。'},
      {en:'Seasonal fires help maintain savanna ecosystems.', ja:'季節的な火災はサバンナの生態系維持に寄与する。'},
      {en:'Large herbivores migrate across the savanna.', ja:'大型草食動物がサバンナを回遊する。'}
    ] },
    { en:'tundra', ja:'ツンドラ', phrases:[
      {en:'Tundra has permafrost near the surface.', ja:'ツンドラは地表近くに永久凍土がある。'},
      {en:'Short summers limit plant growth.', ja:'短い夏は植物の成長を制限する。'},
      {en:'Migratory birds breed in the Arctic tundra.', ja:'渡り鳥は北極圏のツンドラで繁殖する。'}
    ] },
    { en:'glacier', ja:'氷河', phrases:[
      {en:'A glacier is a mass of moving ice.', ja:'氷河は動く氷の塊である。'},
      {en:'Glaciers carve U-shaped valleys as they advance.', ja:'氷河は前進しながらU字谷を削る。'},
      {en:'Retreating glaciers indicate warming trends.', ja:'氷河の後退は温暖化の傾向を示す。'}
    ] },
    { en:'volcano', ja:'火山', phrases:[
      {en:'A volcano erupts molten rock called magma or lava.', ja:'火山はマグマ（溶岩）を噴出する。'},
      {en:'Volcanic arcs form above subduction zones.', ja:'火山弧は沈み込み帯の上に形成される。'},
      {en:'Ash from volcanoes can enrich soils.', ja:'火山灰は土壌を肥沃にし得る。'}
    ] },
    { en:'earthquake', ja:'地震', phrases:[
      {en:'Earthquakes occur when stress is released along faults.', ja:'断層で応力が解放されると地震が起こる。'},
      {en:'The epicenter is the point on the surface above the focus.', ja:'震央は震源の真上の地表の点である。'},
      {en:'Seismic waves travel through Earth’s crust and mantle.', ja:'地震波は地殻やマントルを伝わる。'}
    ] },
    { en:'population density', ja:'人口密度', phrases:[
      {en:'Population density varies widely among cities.', ja:'人口密度は都市によって大きく異なる。'},
      {en:'High density can strain infrastructure.', ja:'高密度はインフラに負荷をかけ得る。'},
      {en:'Census data helps map population density.', ja:'国勢調査は人口密度の地図化に役立つ。'}
    ] },
    { en:'capital city', ja:'首都', phrases:[
      {en:'A capital city hosts national government offices.', ja:'首都には国家の政府機関が置かれる。'},
      {en:'Some countries have multiple capital cities.', ja:'複数の首都を持つ国もある。'},
      {en:'Relocating a capital can spur regional development.', ja:'遷都は地域開発を促すことがある。'}
    ] },
    { en:'border', ja:'国境・境界', phrases:[
      {en:'Borders can be natural or artificial.', ja:'国境は自然的なものと人工的なものがある。'},
      {en:'Rivers and mountains often form borders.', ja:'河川や山脈が国境となることが多い。'},
      {en:'Border control manages the movement of people and goods.', ja:'国境管理は人や物の移動を管理する。'}
    ] },
    { en:'region', ja:'地域', phrases:[
      {en:'A region is an area with common features.', ja:'地域とは共通の特徴を持つ領域である。'},
      {en:'Regions can be defined by climate, culture, or economy.', ja:'地域は気候・文化・経済で定義できる。'},
      {en:'Administrative regions help organize governance.', ja:'行政地域は統治を整理するのに役立つ。'}
    ] },
    { en:'map scale', ja:'地図の縮尺', phrases:[
      {en:'Map scale shows the ratio of map distance to real distance.', ja:'地図の縮尺は地図上の距離と実距離の比率を示す。'},
      {en:'Large-scale maps show more detail of small areas.', ja:'大縮尺図は狭い範囲を詳細に示す。'},
      {en:'Always check the scale before measuring.', ja:'測定の前に縮尺を必ず確認する。'}
    ] },
    { en:'compass rose', ja:'方位記号（羅針図）', phrases:[
      {en:'A compass rose indicates the cardinal directions.', ja:'方位記号は基本方位を示す。'},
      {en:'Maps use the compass rose to orient readers.', ja:'地図は読者の向きを示すために方位記号を用いる。'},
      {en:'North is typically at the top of modern maps.', ja:'現代の地図では北が上に描かれるのが一般的だ。'}
    ] }
  ];

  // --- State -----------------------------------------------------------
  let idx = 0;
  let revealed = false;
  let revealTotal = Number(localStorage.getItem('revealTotal')||0);
  let cycleReveals = Number(sessionStorage.getItem('cycleReveals')||0);
  const cycleGoal = dataset.length; // 一周分の目標

  // --- Elements --------------------------------------------------------
  const els = {
    term: document.getElementById('term'),
    meaning: document.getElementById('meaning'),
    phrases: document.getElementById('phrases'),
    progress: document.getElementById('progress'),
    cycleFill: document.getElementById('cycleFill'),
    cycleText: document.getElementById('cycleText'),
    revealCount: document.getElementById('revealCount'),
    card: document.getElementById('card')
  };

  // --- Rendering -------------------------------------------------------
  function render(){
    const item = dataset[idx];
    els.term.textContent = item.en;
    els.meaning.textContent = revealed ? item.ja : '';
    els.phrases.innerHTML = '';
    item.phrases.forEach(p => {
      const line = document.createElement('div');
      line.className = 'phrase-line';
      const en = document.createElement('div');
      en.className = 'phrase-en';
      en.textContent = p.en;
      const ja = document.createElement('div');
      ja.className = 'phrase-ja';
      ja.textContent = p.ja;
      ja.style.visibility = revealed ? 'visible' : 'hidden';
      line.appendChild(en);
      line.appendChild(ja);
      els.phrases.appendChild(line);
    });
    els.progress.textContent = `${idx+1} / ${dataset.length}`;

    const pct = Math.min(100, (cycleReveals / cycleGoal) * 100);
    els.cycleFill.style.width = pct + '%';
    els.revealCount.textContent = String(revealTotal);
    const bar = els.cycleFill.parentElement;
    bar.setAttribute('aria-valuemax', String(cycleGoal));
    bar.setAttribute('aria-valuenow', String(cycleReveals));
    els.cycleText.textContent = `${cycleReveals} / ${cycleGoal}`;
  }

  // --- Actions ---------------------------------------------------------
  function doReveal(){
    if(!revealed){
      revealed = true;
      revealTotal += 1;
      cycleReveals += 1;
      localStorage.setItem('revealTotal', String(revealTotal));
      sessionStorage.setItem('cycleReveals', String(cycleReveals));
      try{ if('vibrate' in navigator) navigator.vibrate(10); }catch(_){/* noop */}
      if(cycleReveals >= cycleGoal){
        pulseBar();
        cycleReveals = 0;
        sessionStorage.setItem('cycleReveals', '0');
      }
      render();
    } else {
      revealed = false; render();
    }
  }

  function next(){
    if(!revealed){ doReveal(); }
    else { revealed=false; idx=(idx+1)%dataset.length; render(); }
  }
  function prev(){
    if(revealed){ revealed=false; render(); }
    else { idx=(idx-1+dataset.length)%dataset.length; render(); }
  }

  function pulseBar(){
    const el = els.cycleFill;
    el.animate([
      {filter:'brightness(1)'},
      {filter:'brightness(2)'},
      {filter:'brightness(1)'}
    ], {duration:600, easing:'ease-in-out'});
  }

  // --- Events ----------------------------------------------------------
  els.card.addEventListener('click', next);
  window.addEventListener('keydown', e=>{
    if(['Space','Enter','ArrowRight','ArrowLeft'].includes(e.code)) e.preventDefault();
    if(e.code==='Space' || e.code==='Enter') doReveal();
    else if(e.code==='ArrowRight') next();
    else if(e.code==='ArrowLeft') prev();
  }, {passive:false});

  // --- Simple Tests (console) -----------------------------------------
  ;(function runTests(){
    const results = [];
    const assert = (name, cond)=>{ results.push({name, pass: !!cond}); console[cond? 'log':'error']((cond?'✅':'❌')+" "+name); };

    render();
    const firstJa = document.querySelector('.phrase-ja');
    assert('JA exists after initial render', !!firstJa);
    assert('JA hidden when not revealed', firstJa && firstJa.style.visibility === 'hidden');
    assert('JA reserves height (offsetHeight > 0)', firstJa && firstJa.offsetHeight > 0);

    const prevTotal = Number(localStorage.getItem('revealTotal')||0);
    const prevCycle = Number(sessionStorage.getItem('cycleReveals')||0);
    doReveal();
    const firstJaAfter = document.querySelector('.phrase-ja');
    assert('JA visible after reveal', firstJaAfter && firstJaAfter.style.visibility === 'visible');
    assert('revealTotal increments', Number(localStorage.getItem('revealTotal')||0) === prevTotal + 1);
    const cyc = Number(sessionStorage.getItem('cycleReveals')||0);
    assert('cycleReveals increments or resets at goal', cyc === prevCycle + 1 || (prevCycle + 1 === cycleGoal && cyc === 0));

    revealed = false; render();
    cycleReveals = cycleGoal - 1; sessionStorage.setItem('cycleReveals', String(cycleReveals)); render();
    doReveal();
    assert('cycle resets to 0 at goal', Number(sessionStorage.getItem('cycleReveals')||0) === 0);

    revealed = false; render();
    console.log('Test summary:', results);
  })();
  </script>
</body>
</html>